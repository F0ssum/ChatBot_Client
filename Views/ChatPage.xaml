<Window x:Class="ChatBotClient.Views.ChatPage"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ChatBotClient.Views"
        xmlns:converters="clr-namespace:ChatBotClient.Converters"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        Title="Chat" Height="500" Width="600"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <converters:MessageConverter x:Key="MessageConverter"/>
        <converters:KeyValueConverter x:Key="KeyValueConverter"/>

        <Style TargetType="TextBlock" x:Key="ProfileTextStyle">
            <Setter Property="Margin" Value="0,0,0,5"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style TargetType="ListBox" x:Key="ChatListBoxStyle">
            <Setter Property="Background" Value="#FFF0F0F0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#FFCCCCCC"/>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Профиль -->
        <Border Grid.Row="0" BorderBrush="#FFCCCCCC" BorderThickness="0,0,0,1" Padding="0,0,0,5" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock Text="{Binding Profile.Username, StringFormat='Username: {0}'}" 
                           Style="{StaticResource ProfileTextStyle}"/>
                <TextBlock Text="{Binding Profile.Email, StringFormat='Email: {0}'}" 
                           Style="{StaticResource ProfileTextStyle}"/>
                <TextBlock Text="Mood Stats:" FontWeight="Bold" Style="{StaticResource ProfileTextStyle}"/>
                <ItemsControl ItemsSource="{Binding MoodStats}" Margin="10,0,0,0">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Path=., Converter={StaticResource KeyValueConverter}}"
                                       Style="{StaticResource ProfileTextStyle}"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Border>

        <!-- Чат -->
        <ListBox Grid.Row="1" ItemsSource="{Binding Messages}" 
                 Style="{StaticResource ChatListBoxStyle}">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Path=., Converter={StaticResource MessageConverter}}"
                               TextWrapping="Wrap" Margin="5"/>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <!-- Ввод -->
        <Grid Grid.Row="2" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBox Text="{Binding InputText, UpdateSourceTrigger=PropertyChanged}" 
                     Margin="0,0,5,0" VerticalAlignment="Center"/>

            <Button Command="{Binding SendCommand}" Content="Send" 
                    Grid.Column="1" Width="80" Margin="0,0,5,0"/>

            <TextBlock Text="{Binding SendStatus}" Grid.Column="2" 
                       VerticalAlignment="Center" Foreground="Gray"/>
        </Grid>
    </Grid>
</Window>